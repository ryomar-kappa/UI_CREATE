# L'Oreal Beauty Genius UI 実装計画

## 1. 観察されたアニメーションと UI フロー

### 🎯 メインワークフロー

```
製品ページ → Beauty Genius Modal → 画像アップロード → 年齢入力 → 肌分析結果 → スキンケア推奨
```

### 🔄 確認されたアニメーション

1. **モーダルの登場**: 下からスライドイン
2. **ステップ遷移**: フェードイン/アウト + スライド
3. **ボタン状態変化**: ホバー・プレス時のマイクロインタラクション
4. **画像アップロード**: プログレス表示
5. **結果表示**: 段階的な情報開示

## 2. デザイントークン

### 🎨 カラーパレット

```typescript
const colors = {
  primary: {
    main: "#1A1A1A", // L'Oreal黒
    light: "#333333",
    dark: "#000000",
  },
  accent: {
    main: "#B8860B", // L'Orealゴールド
    light: "#DAA520",
    dark: "#8B7355",
  },
  neutral: {
    50: "#FAFAFA",
    100: "#F5F5F5",
    200: "#E5E5E5",
    300: "#D4D4D4",
    400: "#A3A3A3",
    500: "#737373",
    600: "#525252",
    700: "#404040",
    800: "#262626",
    900: "#171717",
  },
  semantic: {
    success: "#10B981",
    warning: "#F59E0B",
    error: "#EF4444",
    info: "#3B82F6",
  },
};
```

### 📝 タイポグラフィ

```typescript
const typography = {
  fontFamily: {
    primary: "'Helvetica Neue', Arial, sans-serif",
  },
  fontSize: {
    xs: "0.75rem", // 12px
    sm: "0.875rem", // 14px
    base: "1rem", // 16px
    lg: "1.125rem", // 18px
    xl: "1.25rem", // 20px
    "2xl": "1.5rem", // 24px
    "3xl": "1.875rem", // 30px
  },
  fontWeight: {
    normal: "400",
    medium: "500",
    semibold: "600",
    bold: "700",
  },
};
```

### 📏 スペーシング

```typescript
const spacing = {
  xs: "0.25rem", // 4px
  sm: "0.5rem", // 8px
  md: "1rem", // 16px
  lg: "1.5rem", // 24px
  xl: "2rem", // 32px
  "2xl": "3rem", // 48px
  "3xl": "4rem", // 64px
};
```

### 🎬 アニメーション

```typescript
const animations = {
  duration: {
    fast: "150ms",
    normal: "300ms",
    slow: "500ms",
  },
  easing: {
    easeOut: "cubic-bezier(0, 0, 0.2, 1)",
    easeIn: "cubic-bezier(0.4, 0, 1, 1)",
    easeInOut: "cubic-bezier(0.4, 0, 0.2, 1)",
  },
};
```

## 3. コンポーネント構造

### 🏗️ メインコンポーネント

```typescript
// BeautyGeniusWorkflow.tsx
interface BeautyGeniusWorkflowProps {
  isOpen: boolean;
  onClose: () => void;
  productData?: ProductData;
}

// ワークフローステップ
enum WorkflowStep {
  WELCOME = "welcome",
  IMAGE_UPLOAD = "image_upload",
  AGE_INPUT = "age_input",
  ANALYSIS_RESULT = "analysis_result",
  SKINCARE_RECOMMENDATION = "skincare_recommendation",
}
```

### 📱 コンポーネント分割

```
BeautyGeniusWorkflow/
├── BeautyGeniusModal.tsx          # メインモーダル
├── steps/
│   ├── WelcomeStep.tsx           # 初期画面
│   ├── ImageUploadStep.tsx       # 画像アップロード
│   ├── AgeInputStep.tsx          # 年齢入力
│   ├── AnalysisResultStep.tsx    # 分析結果
├── components/
│   ├── StepTransition.tsx        # ステップ遷移アニメーション
│   ├── ProgressIndicator.tsx     # プログレス表示
│   ├── ImageUploader.tsx         # 画像アップロード機能
│   └── SkinTypeSelector.tsx      # 肌タイプ選択
└── hooks/
    ├── useWorkflowStep.tsx       # ステップ管理
    ├── useImageAnalysis.tsx      # 画像分析API
    └── useBeautyGenius.tsx       # 全体状態管理
```

## 4. アニメーション実装詳細

### 🎭 Framer Motion 設定

#### モーダル登場アニメーション

```typescript
const modalVariants = {
  hidden: {
    y: "100%",
    opacity: 0,
  },
  visible: {
    y: 0,
    opacity: 1,
    transition: {
      type: "spring",
      damping: 25,
      stiffness: 300,
      duration: 0.5,
    },
  },
  exit: {
    y: "100%",
    opacity: 0,
    transition: {
      duration: 0.3,
    },
  },
};
```

#### ステップ遷移アニメーション

```typescript
const stepVariants = {
  enter: {
    x: 50,
    opacity: 0,
  },
  center: {
    x: 0,
    opacity: 1,
    transition: {
      duration: 0.3,
      ease: "easeOut",
    },
  },
  exit: {
    x: -50,
    opacity: 0,
    transition: {
      duration: 0.3,
      ease: "easeIn",
    },
  },
};
```

#### プログレス表示アニメーション

```typescript
const progressVariants = {
  initial: { width: 0 },
  animate: (progress: number) => ({
    width: `${progress}%`,
    transition: {
      duration: 0.5,
      ease: "easeOut",
    },
  }),
};
```

## 5. 主要機能の実装アプローチ

### 📸 画像アップロード

```typescript
const ImageUploadStep = () => {
  const [uploadProgress, setUploadProgress] = useState(0);
  const [analysisStatus, setAnalysisStatus] = useState<
    "idle" | "uploading" | "analyzing" | "complete"
  >("idle");

  const handleImageUpload = async (file: File) => {
    setAnalysisStatus("uploading");

    // アップロード進捗アニメーション
    const simulateProgress = () => {
      const interval = setInterval(() => {
        setUploadProgress((prev) => {
          if (prev >= 100) {
            clearInterval(interval);
            setAnalysisStatus("analyzing");
            return 100;
          }
          return prev + 10;
        });
      }, 100);
    };

    simulateProgress();

    // 実際のAPI呼び出し
    await analyzeImage(file);
    setAnalysisStatus("complete");
  };

  return (
    <motion.div variants={stepVariants}>{/* アップロードUI */}</motion.div>
  );
};
```

### 🎚️ 年齢入力スピナー

```typescript
const AgeInputStep = () => {
  const [age, setAge] = useState(25);

  return (
    <motion.div variants={stepVariants}>
      <div className="flex items-center justify-center space-x-4">
        <motion.button
          whileTap={{ scale: 0.95 }}
          onClick={() => setAge(Math.max(18, age - 1))}
          className="p-2 rounded-full bg-gray-200 hover:bg-gray-300"
        >
          -
        </motion.button>

        <motion.div
          key={age}
          initial={{ scale: 1.1, opacity: 0 }}
          animate={{ scale: 1, opacity: 1 }}
          className="text-2xl font-bold min-w-[60px] text-center"
        >
          {age}
        </motion.div>

        <motion.button
          whileTap={{ scale: 0.95 }}
          onClick={() => setAge(Math.min(100, age + 1))}
          className="p-2 rounded-full bg-gray-200 hover:bg-gray-300"
        >
          +
        </motion.button>
      </div>
    </motion.div>
  );
};
```

### 📊 分析結果の段階的表示

```typescript
const AnalysisResultStep = () => {
  const analysisSteps = [
    { text: "写真をアップロードしていただき、ありがとうございます", delay: 0 },
    { text: "25,000枚の画像と比較しています", delay: 1000 },
    { text: "肌分析が完了しました", delay: 2000 },
    { text: "あなたの肌タイプは「乾燥肌」と判定されました", delay: 3000 },
  ];

  return (
    <motion.div variants={stepVariants}>
      <AnimatePresence mode="wait">
        {analysisSteps.map((step, index) => (
          <motion.div
            key={index}
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: step.delay / 1000 }}
            className="mb-4 p-4 bg-gray-50 rounded-lg"
          >
            {step.text}
          </motion.div>
        ))}
      </AnimatePresence>
    </motion.div>
  );
};
```

## 6. 状態管理

### 🗂️ Zustand Store

```typescript
interface BeautyGeniusStore {
  // 状態
  currentStep: WorkflowStep;
  isOpen: boolean;
  uploadedImage: File | null;
  userAge: number;
  skinType: "dry" | "oily" | "normal" | "combination" | "sensitive";
  analysisResult: AnalysisResult | null;

  // アクション
  setStep: (step: WorkflowStep) => void;
  setImage: (file: File) => void;
  setAge: (age: number) => void;
  setSkinType: (type: string) => void;
  setAnalysisResult: (result: AnalysisResult) => void;
  reset: () => void;
}
```

## 7. レスポンシブ対応

### 📱 モバイルファースト

```css
/* Tailwind CSS classes */
.beauty-genius-modal {
  @apply fixed inset-0 z-50;
  @apply md:inset-4 md:max-w-md md:mx-auto;
  @apply bg-white rounded-none md:rounded-2xl;
  @apply shadow-none md:shadow-2xl;
}

.modal-content {
  @apply h-full overflow-y-auto;
  @apply md:h-auto md:max-h-[90vh];
  @apply p-6 md:p-8;
}
```

## 8. アクセシビリティ

### ♿ 主要対応項目

- **キーボードナビゲーション**: Tab/Enter/Escape 対応
- **スクリーンリーダー**: ARIA 属性とセマンティック HTML
- **フォーカス管理**: モーダル内でのフォーカストラップ
- **色彩対比**: WCAG 2.1 AA 準拠
- **動作軽減**: `prefers-reduced-motion`対応

```typescript
// reduced-motion対応
const useReducedMotion = () => {
  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false);

  useEffect(() => {
    const mediaQuery = window.matchMedia("(prefers-reduced-motion: reduce)");
    setPrefersReducedMotion(mediaQuery.matches);

    const handleChange = () => setPrefersReducedMotion(mediaQuery.matches);
    mediaQuery.addEventListener("change", handleChange);

    return () => mediaQuery.removeEventListener("change", handleChange);
  }, []);

  return prefersReducedMotion;
};
```

## 9. パフォーマンス最適化

### ⚡ 最適化戦略

- **コードスプリッティング**: 各ステップの遅延読み込み
- **画像最適化**: WebP 対応、適切なサイズ調整
- **アニメーション最適化**: `transform`と`opacity`の使用
- **バンドルサイズ**: Tree shaking 対応

```typescript
// 遅延読み込み
const ImageUploadStep = lazy(() => import("./steps/ImageUploadStep"));
const AgeInputStep = lazy(() => import("./steps/AgeInputStep"));
const AnalysisResultStep = lazy(() => import("./steps/AnalysisResultStep"));
```

## 10. 実装優先度

### 🚀 Phase 1 (MVP)

1. ✅ 基本モーダル構造
2. ✅ ステップ遷移アニメーション
3. ✅ 画像アップロード機能
4. ✅ 年齢入力コンポーネント

### 🔧 Phase 2 (Enhanced)

1. 🔄 画像分析 API 統合
2. 🔄 詳細なプログレス表示
3. 🔄 肌タイプ判定ロジック
4. 🔄 商品推奨システム

### 🎨 Phase 3 (Polish)

1. ⏳ マイクロインタラクション
2. ⏳ 高度なアニメーション
3. ⏳ A/B テスト対応
4. ⏳ アナリティクス統合

この実装計画により、L'Oreal Beauty Genius の魅力的な UI とスムーズなアニメーションを再現できます。
